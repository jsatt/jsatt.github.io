<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width"><title>Decorators vs Mixins for Django Class-Based Views</title><link rel=alternate type=application/rss+xml title=RSS href=https://jsatt.com/blog/feeds/rss/><link rel=alternate type=application/atom+xml title=Atom href=https://jsatt.com/blog/feeds/atom/><link rel=stylesheet href=../../static/css/bootstrap.min.css><link rel=stylesheet href=../../static/css/fontawesome.min.css><link rel=stylesheet href=../../static/css/prism.css><link rel=stylesheet href=../../static/css/main.css></head><body id=page_blog_post><header><nav><div class=container><div class=row><div class=col-md-12><ul class="nav navbar-nav"><li id=menu-link-blog><a href=https://jsatt.com/blog/>Blog</a></li><li id=menu-link-about><a href=https://jsatt.com/about/>About</a></li></ul></div></div></div></nav><div class=title><a href=../../>Jeremy Satterfield</a></div><div class=tagline>Coding, Making and Tulsa Life</div></header><section id=content><div class=container><div class=row><article class=col-md-8 itemscope itemtype=http://schema.org/BlogPosting><h1 class=headline itemprop=headline>Decorators vs Mixins for Django Class-Based Views</h1><h6 class=post-meta>Posted by:
<span itemscope itemprop=author itemtype=http://schema.org/Person><span itemprop=name>Jeremy Satterfield</span></span>
in
<a itemprop=articleSection href=https://jsatt.com/categories/development/>development</a>
on <span itemprop=datePublished>2014-01-13</span><ul class="list-inline tags"><li>Tags:</li><li><a href=https://jsatt.com/tags/django/>django</a></li><li><a href=https://jsatt.com/tags/python/>python</a></li><li><a href=https://jsatt.com/tags/class-based-views/>class-based views</a></li></ul></h6><div class=post itemprop=articleBody><p>I've been huge fan of Django's class-based views (CBVs) since I first tried them out in Django 1.4.&nbsp; While they're much more complicated then the classic function based views, once you understand how they work, they're much more powerful, flexible and allow for DRYer code. I highly recommend anyone who hasn't delved into CBVs take a look at <a href=http://ccbv.co.uk/>Class Class-based</a><a href=http://ccbv.co.uk/> views</a> or <a href=https://godjango.com/15-class-based-views-part-1-templateview-and-redirectview/>GoDjango</a>.</p><p>However, one of the early issues I ran into was for views that required Django user permissions. With function based views, Django's auth application provides decorators to check that users are logged in, have a specific permission, or pass other custom checks the developer can provide. You simply add the decorator to the view...</p><pre><code class=language-python>@permission_required(&#39;auth.change_user&#39;)
def user_list(request):
	...</code></pre><p>And now any user that doesn't have the required permission is redirected to the login page.</p><p>For CBVs though, it's not quite that simple, it's the dispatch method that begins the process that you're used to picking up from with function based views. This means that to apply a decorator to the CBV, you have a couple of options.</p><p>You can override the dispatch method to apply the decorator:</p><pre><code class=language-python>class UserListView(ListView):
    model = User

    @my_custom_decorator
    def dispatch(self, request, *args, **kwargs):
        return super(UserListView, self).dispatch(request, *args, **kwargs)</code></pre><p>You could write a reusable class view decorator:</p><pre><code class=language-python>def class_view_decorator(function_decorator):
    def deco(View):
        View.dispatch = method_decorator(function_decorator)(View.dispatch)
        return View
    return deco

@class_view_decorator(my_custom_decorator)
class UserListView(ListView):
    model = User</code></pre><p>This second option is the one that I've lived with for a long time. It's relatively clean and DRY and not much different than what you're used to seeing with function views.</p><p>But recently I was pointed toward <a href=https://github.com/brack3t/django-braces>Django Braces</a>. It's a library of commonly (and not-so-commonly) needed view decorator-like functionality in the form of mixins. I immediately realized that when thinking about the functionality these decorators provide, I was stuck in the old way of doing things rather than looks at these views from an OOP perspective.</p><p>Writing these decorators as mixins instead, makes them more flexible, extensible and DRYer, just like the move from function views to CBVs. You're able to build a base mixin that others can inherit from and extend. What would have been arguments to the decorator can are much cleaner as class attributes for the view that's extending it. You can even have views that apply affect the mixin on a one-off basis. Take for instance the &lt;code>UserCheckMixin&lt;/code> below.</p><pre><code class=language-python>class UserCheckMixin(object):
    user_check_failure_path = &#39;&#39;  # can be path, url name or reverse_lazy

    def check_user(self, user):
        return True

    def user_check_failed(self, request, *args, **kwargs):
        return redirect(self.user_check_failure_path)

    def dispatch(self, request, *args, **kwargs):
        if not self.check_user(request.user):
            return self.user_check_failed(request, *args, **kwargs)
  return super(UserCheckMixin, self).dispatch(request, *args, **kwargs)</code></pre><p>I now simply add the mixin to a view:</p><pre><code class=language-python>class UserListView(UserCheckMixin, ListView):
    model = User
    user_check_failure_path = &#39;auth_login&#39;

    def check_user(self, user)
        # do some check against the user here and return True or False</code></pre><p>You can extend it to build a more useful mixin:</p><pre><code class=language-python>class PermissionRequiredMixin(UserCheckMixin):
    user_check_failure_path = &#39;auth_login&#39;
    permission_required = None

    def check_user(self, user):
        return user.has_perm(self.permission_required)

class UserListView(PermissionRequredMixin, ListView):
    model = User
    permission_required = &#39;auth.change_user&#39;
    user_check_failure_path = &#39;auth_login&#39;</code></pre><p>As you can see, once you've defined the <code>PermissionRequiredMixin</code>, it's much cleaner, more object-oriented and I would argue more pythonic.</p><p>If you're relying on built-in decorators, the <code>class_view_decorator</code> is a pretty helpful tool to have in your codebase. But for anything custom you may be writing, it really is hard to beat a mixin.</p></div></article><aside class=col-md-4><nav class=social-icons><a href=https://github.com/jsatt rel=me target=_blank><i class="fa-brands fa-github" title="Github: jsatt"></i></a>
<a href=https://www.facebook.com/jsatt0 rel=me target=_blank><i class="fa-brands fa-facebook" title="Facebook: jsatt0"></i></a>
<a href=https://twitter.com/jsatt rel=me target=_blank><i class="fa-brands fa-twitter" title="Twitter: @jsatt"></i></a>
<a href=https://fosstodon.org/@jsatt rel=me target=_blank><i class="fa-brands fa-mastodon" title="Mastodon: @jsatt@fosstodon.org"></i></a>
<a href=https://www.linkedin.com/in/jsatterfield rel=me target=_blank><i class="fa-brands fa-linkedin" title="Linkedin: jsatterfield"></i></a>
<a href=mailto:jsatt@jsatt.com><i class="fa-solid fa-envelope" title="Email: jsatt@jsatt.com"></i></a>
<a href=https://jsatt.com/blog/feeds/rss/ target=_blank><i class="fa-solid fa-square-rss" title=RSS></i></a></nav><div class=keywords><div class=keyword><a href=https://jsatt.com/tags/python/>#python</a></div><div class=keyword><a href=https://jsatt.com/tags/testing/>#testing</a></div><div class=keyword><a href=https://jsatt.com/tags/django/>#django</a></div><div class=keyword><a href=https://jsatt.com/tags/hacks/>#hacks</a></div><div class=keyword><a href=https://jsatt.com/tags/mocking/>#mocking</a></div><div class=keyword><a href=https://jsatt.com/tags/django-rest-framework/>#django-rest-framework</a></div><div class=keyword><a href=https://jsatt.com/tags/celery/>#celery</a></div><div class=keyword><a href=https://jsatt.com/tags/class-based-views/>#class-based-views</a></div><div class=keyword><a href=https://jsatt.com/tags/data-structures/>#data-structures</a></div><div class=keyword><a href=https://jsatt.com/tags/dev-ops/>#dev-ops</a></div><div class=keyword><a href=https://jsatt.com/tags/docker/>#docker</a></div><div class=keyword><a href=https://jsatt.com/tags/go/>#go</a></div><div class=keyword><a href=https://jsatt.com/tags/linux/>#linux</a></div><div class=keyword><a href=https://jsatt.com/tags/node/>#node</a></div><div class=keyword><a href=https://jsatt.com/tags/nose/>#nose</a></div><div class=keyword><a href=https://jsatt.com/tags/open-source/>#open-source</a></div><div class=keyword><a href=https://jsatt.com/tags/packages/>#packages</a></div><div class=keyword><a href=https://jsatt.com/tags/ruby/>#ruby</a></div><div class=keyword><a href=https://jsatt.com/tags/rust/>#rust</a></div><div class=keyword><a href=https://jsatt.com/tags/tox/>#tox</a></div><div class=keyword><a href=https://jsatt.com/tags/travis-ci/>#travis-ci</a></div><div class=keyword><a href=https://jsatt.com/tags/virtualenvs/>#virtualenvs</a></div></div></aside></div></div></section><footer><div class=container><div class=row><div class=col-md-12><div class=nav-footer><ul class=list-unstyled><li id=footer-menu-presentations><a href=https://jsatt.com/presentations/>Presentations</a></li><li id=footer-menu-resume><a href=https://jsatt.com/resume/>Resume</a></li></ul></div></div></div></div></footer><script src=../../static/js/jquery.min.js></script>
<script src=../../static/js/prism.js></script>
<script src=../../static/js/bootstrap.min.js></script></body></html>